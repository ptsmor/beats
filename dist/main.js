"use strict";var myMap,player,button=document.querySelector("#hamburger__container"),menu=document.querySelector("#fullscreen-menu"),hamburger=document.querySelector("#hamburger"),body=document.querySelector("body"),toggleMenu=function(e){e.preventDefault(),button.classList.toggle("hamburger__container--active"),hamburger.classList.toggle("hamburger--active"),menu.classList.toggle("fullscreen-menu--open"),body.classList.toggle("body-active-menu")},init=(button.addEventListener("click",toggleMenu),$(".fullscreen-menu__link").on("click",toggleMenu),function(){myMap=new ymaps.Map("map",{center:[55.752137,37.589335],zoom:13,controls:[]});for(var e=[[55.756012,37.604021],[55.75092,37.615746],[55.746988,37.591715],[55.744078,37.591413]],t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/marker8.png",iconImageSize:[46,57],iconImageOffset:[-35,-52]}),a=0;a<e.length;a++)t.add(new ymaps.Placemark(e[a]));myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom")}),validateFields=(ymaps.ready(init),function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""==e.val().trim()&&e.addClass("input-error")}),0==e.find(".input-error").length}),sections=($(".form").submit(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.find("[name='name']"),a=e.find("[name='phone']"),n=e.find("[name='comment']"),i=e.find("[name='to']"),r=$("#modal"),o=r.find(".modal__content");r.removeClass("error-modal"),validateFields(e,[t,a,n,i])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:t.val(),phone:a.val(),comment:n.val(),to:i.val()}})).done(function(e){o.text(e.message)}),e.fail(function(e){e=e.responseJSON.message;o.text(e),r.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-close-modal").click(function(e){e.preventDefault(),$.fancybox.close()}),$("section")),display=$(".maincontent"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find("fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1,countSectionPosition=(sections.first().addClass("active"),function(e){e*=-100;return isNaN(e)?(console.error("передано не верное значение в countSectionPosition"),0):e}),resetActiveClassForItem=function(e,t,a){e.eq(t).addClass(a).siblings().removeClass(a)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),sections.eq(e).addClass("active").siblings().removeClass("active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active"),sideMenu.find(".fixed-menu__item").eq(e).addClass("fixed-menu__item--active").siblings().removeClass("fixed-menu__item--active")},1300))},viewportScroller=function(){var e=sections.filter(".active"),t=e.next(),a=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){a.length&&performTransition(a.index())}}},playerContainer=($(window).on("wheel",function(e){var e=e.originalEvent.deltaY,t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"==t||"textarea"==t,a=viewportScroller();if(!t)switch(e.keyCode){case 38:a.prev();break;case 40:a.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewportScroller()["down"==t?"prev":"up"==t?"next":""]()}}),$(".player")),playerStart=$(".player__start"),eventsInit=function(){$(".player__start").click(function(e){e.preventDefault(),playerStart.hasClass("player__start--active")?player.pauseVideo():player.playVideo()}),$(".player__playback").click(function(e){var t=$(e.currentTarget),e=e.originalEvent.layerX/t.width()*100,t=player.getDuration()/100*e;$(".player__playback-line").css({width:"".concat(e,"%")}),player.seekTo(t)}),$(".player__splash").click(function(e){player.playVideo()}),$(".player__volume").click(function(e){var t=$(e.currentTarget),e=e.originalEvent.layerX/t.width()*100;$(".player__volume-button").css({left:"".concat(e,"%")}),player.setVolume(e)})},formatTime=function(e){var e=Math.round(e),t=a(Math.floor(e/60)),e=a(e-60*t);function a(e){return e<10?"0".concat(e):e}return"".concat(t," : ").concat(e)},onPlayerReady=function(){var a=player.getDuration(),e=($(".player__duration-estimate").text(formatTime(a)),void 0!==e&&clearInterval(e),e=setInterval(function(){var e=player.getCurrentTime(),t=e/a*100;$(".player__playback-line").css({width:"".concat(t,"%")}),$(".player__duration-completed").text(formatTime(e))},1e3),player.getVolume());$(".player__volume-button").css({left:"".concat(e,"%")})},onPlayerStateChange=function(e){switch(e.data){case 1:playerContainer.addClass("player--active"),playerStart.addClass("player__start--active");break;case 2:playerContainer.removeClass("player--active"),playerStart.removeClass("player__start--active")}},playerVolumeIcon=$(".player__volume-icon");function onYouTubeIframeAPIReady(){player=new YT.Player("yt-player",{height:"rem(392)",width:"rem(662)",videoId:"hk3KPa6zWzo",events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange},playerVars:{controls:0,disablekb:1,showinfo:0,rel:0,autoplay:0,modestbranding:0}})}$(".player__volume-icon").click(function(e){0==player.getVolume()?(player.setVolume("100"),playerVolumeIcon.removeClass("muted"),$(".player__volume-button").css({left:"100%"})):(player.setVolume("0"),playerVolumeIcon.addClass("muted"),$(".player__volume-button").css({left:"0%"}))}),eventsInit();var list=$(".products-menu__list"),slider=(list.on("click",".product",function(e){e.preventDefault(),$(this).siblings("li").removeClass("product--active"),$(this).toggleClass("product--active");var e=$(this).find(".product__content"),t=0,a=524;$(window).width()<=768&&480<$(window).width()&&(t=$(".product__title").width()*$(".product__title").length,a=$(window).width()-t),$(window).width()<480&&(t=$(".product__title").width(),a=$(window).width()-t),list.find(".product__content").css("width",0),$(this).hasClass("product--active")&&e.css("width","".concat(a,"px"))}),$(".shop__list").bxSlider({pager:!1,controls:!1})),findBlockByAlias=($(".shop__btn_left").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".shop__btn_right").click(function(e){e.preventDefault(),slider.goToNextSlide()}),function(a){return $(".reviews__item").filter(function(e,t){return $(t).attr("data-linked-with")==a})}),openItem=($(".interactive-avatar__link").click(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.attr("data-open"),t=findBlockByAlias(t),e=e.closest(".interactive-avatar");t.addClass("reviews__item--active").siblings().removeClass("reviews__item--active"),e.addClass("interactive-avatar--active").siblings().removeClass("interactive-avatar--active")}),function(e){var e=e.closest(".slider__item"),t=e.find(".slider__description"),a=t.find(".slider__description--wrap").height();e.addClass(".slider__item--active"),t.height(a)}),closeEveryItem=function(e){var t=e.find(".slider__description");e.find(".slider__item").removeClass(".slider__item--active"),t.height(0)};$(".slider__name").click(function(e){var e=$(e.currentTarget),t=e.closest(".slider__list");e.closest(".slider__item").hasClass(".slider__item--active")?closeEveryItem(t):(closeEveryItem(t),openItem(e))});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJtYXAuanMiLCJwbGF5ZXIuanMiLCJtb2RhbC5qcyIsIm9wcy5qcyIsInByb2R1Y3RzLmpzIiwic2hvcHNsaWRlLmpzIiwidGFicy5qcyIsInRlYW0uanMiXSwibmFtZXMiOlsibXlNYXAiLCJwbGF5ZXIiLCJidXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51IiwiaGFtYnVyZ2VyIiwiYm9keSIsInRvZ2dsZU1lbnUiLCJlIiwicHJldmVudERlZmF1bHQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJpbml0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIiQiLCJvbiIsInltYXBzIiwiTWFwIiwiY2VudGVyIiwiem9vbSIsImNvbnRyb2xzIiwiY29vcmRzIiwibXlDb2xsZWN0aW9uIiwiR2VvT2JqZWN0Q29sbGVjdGlvbiIsImRyYWdnYWJsZSIsImljb25MYXlvdXQiLCJpY29uSW1hZ2VIcmVmIiwiaWNvbkltYWdlU2l6ZSIsImljb25JbWFnZU9mZnNldCIsImkiLCJsZW5ndGgiLCJhZGQiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYmVoYXZpb3JzIiwiZGlzYWJsZSIsInZhbGlkYXRlRmllbGRzIiwicmVhZHkiLCJmb3JtIiwiZmllbGRzQXJyYXkiLCJmb3JFYWNoIiwiZmllbGQiLCJyZW1vdmVDbGFzcyIsInZhbCIsInRyaW0iLCJhZGRDbGFzcyIsImZpbmQiLCJzZWN0aW9ucyIsInN1Ym1pdCIsImN1cnJlbnRUYXJnZXQiLCJuYW1lIiwicGhvbmUiLCJjb21tZW50IiwidG8iLCJtb2RhbCIsImNvbnRlbnQiLCJyZXF1ZXN0IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJmYWlsIiwicmVzcG9uc2VKU09OIiwiYWx3YXlzIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwidHlwZSIsImNsaWNrIiwiY2xvc2UiLCJkaXNwbGF5Iiwic2lkZU1lbnUiLCJtZW51SXRlbXMiLCJtb2JpbGVEZXRlY3QiLCJNb2JpbGVEZXRlY3QiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJpc01vYmlsZSIsIm1vYmlsZSIsImluU2Nyb2xsIiwiY291bnRTZWN0aW9uUG9zaXRpb24iLCJmaXJzdCIsInNlY3Rpb25FcSIsInBvc2l0aW9uIiwiaXNOYU4iLCJjb25zb2xlIiwiZXJyb3IiLCJyZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSIsIml0ZW1zIiwiaXRlbUVxIiwiYWN0aXZlQ2xhc3MiLCJlcSIsInNpYmxpbmdzIiwicGVyZm9ybVRyYW5zaXRpb24iLCJjc3MiLCJ0cmFuc2Zvcm0iLCJjb25jYXQiLCJzZXRUaW1lb3V0IiwidHJhbnNpdGlvbk92ZXIiLCJ2aWV3cG9ydFNjcm9sbGVyIiwiYWN0aXZlU2VjdGlvbiIsImZpbHRlciIsIm5leHRTZWN0aW9uIiwibmV4dCIsInByZXZTZWN0aW9uIiwicHJldiIsImluZGV4IiwicGxheWVyQ29udGFpbmVyIiwiZGVsdGFZIiwib3JpZ2luYWxFdmVudCIsInNjcm9sbGVyIiwidGFnTmFtZSIsInRhcmdldCIsInRvTG93ZXJDYXNlIiwidXNlclR5cGluZ0luSW5wdXRzIiwia2V5Q29kZSIsImF0dHIiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsImRpcmVjdGlvbiIsInBsYXllclN0YXJ0IiwiZXZlbnRzSW5pdCIsImhhc0NsYXNzIiwicGF1c2VWaWRlbyIsInBsYXlWaWRlbyIsImJhciIsIm5ld0J1dHRvblBvc2l0aW9uUGVyY2VudCIsImxheWVyWCIsIndpZHRoIiwibmV3UGxheWJhY2tQb3NpdGlvblNlYyIsImdldER1cmF0aW9uIiwic2Vla1RvIiwidkJhciIsIm5ld3ZCdXR0b25Qb3NpdGlvblBlcmNlbnQiLCJsZWZ0Iiwic2V0Vm9sdW1lIiwiZm9ybWF0VGltZSIsInRpbWVTZWMiLCJyb3VuZFRpbWUiLCJNYXRoIiwicm91bmQiLCJtaW51dGVzIiwiYWRkWmVybyIsImZsb29yIiwic2Vjb25kcyIsIm51bSIsIm9uUGxheWVyUmVhZHkiLCJkdXJhdGlvblNlYyIsInZvbHVtZU51bWJlciIsImludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInNldEludGVydmFsIiwiY29tcGxldGVkU2VjIiwiZ2V0Q3VycmVudFRpbWUiLCJjb21wbGV0ZWRQZXJjZW50IiwiZ2V0Vm9sdW1lIiwib25QbGF5ZXJTdGF0ZUNoYW5nZSIsInBsYXllclZvbHVtZUljb24iLCJvbllvdVR1YmVJZnJhbWVBUElSZWFkeSIsIllUIiwiUGxheWVyIiwiaGVpZ2h0IiwidmlkZW9JZCIsImV2ZW50cyIsIm9uUmVhZHkiLCJvblN0YXRlQ2hhbmdlIiwicGxheWVyVmFycyIsImRpc2FibGVrYiIsInNob3dpbmZvIiwicmVsIiwiYXV0b3BsYXkiLCJtb2Rlc3RicmFuZGluZyIsImxpc3QiLCJzbGlkZXIiLCJ0aGlzIiwidG9nZ2xlQ2xhc3MiLCIkY29udGVudCIsImN1cldpZHRoIiwibmV3V2lkdGgiLCJieFNsaWRlciIsInBhZ2VyIiwiZmluZEJsb2NrQnlBbGlhcyIsImdvVG9QcmV2U2xpZGUiLCJnb1RvTmV4dFNsaWRlIiwiYWxpYXMiLCJuZHgiLCJpdGVtIiwib3Blbkl0ZW0iLCIkdGhpcyIsIml0ZW1Ub1Nob3ciLCJjdXJJdGVtIiwiY2xvc2VzdCIsImNvbnRhaW5lciIsImNvbnRlbnRCbG9jayIsInJlcUhlaWdodCIsImNsb3NlRXZlcnlJdGVtIl0sIm1hcHBpbmdzIjoiYUFBQSxJQ0FBQSxNQ0FBQyxPRkFBQyxPQUFBQyxTQUFBQyxjQUFBLHlCQUNBQyxLQUFBRixTQUFBQyxjQUFBLG9CQURBRSxVQUFBSCxTQUFBQyxjQUFBLGNBQ0FHLEtBQUFKLFNBQUFDLGNBQUEsUUFzQkFJLFdBQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBQ0FSLE9BQUFTLFVBQUFDLE9BQUEsZ0NBQ0FOLFVBQUFLLFVBQUFDLE9BQUEscUJBR0FQLEtBQUFNLFVBQUFDLE9BQUEseUJBREFMLEtBQUFJLFVBQUFDLE9BQUEscUJDM0JBQyxNRGdDQVgsT0FBQVksaUJBQUEsUUFBQU4sWUNq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QXlKLEVBQ0F0SixTQUFBLDhCQUNBbUQsV0FDQXRELFlBQUEsZ0NDdEJBLFNBQUFxSixHQUNBLElBQUFNLEVBQUFOLEVBQUFLLFFBQUEsaUJBQ0FFLEVBQUFELEVBQUF2SixLQUFBLHdCQUVBeUosRUFEQUQsRUFBQXhKLEtBQUEsOEJBQ0F3SCxTQUVBK0IsRUFBQXhKLFNBQUEseUJBQ0F5SixFQUFBaEMsT0FBQWlDLEtBR0FDLGVBQUEsU0FBQUgsR0FDQSxJQUFBekcsRUFBQXlHLEVBQUF2SixLQUFBLHdCQUNBdUosRUFBQXZKLEtBQUEsaUJBRUFKLFlBQUEseUJBQ0FrRCxFQUFBMEUsT0FBQSxJQUdBeEosRUFBQSxpQkFBQXlELE1BQUEsU0FBQS9ELEdBQ0EsSUFBQXlMLEVBQUFuTCxFQUFBTixFQUFBeUMsZUFDQW9KLEVBQUFKLEVBQUFHLFFBQUEsaUJBQ0FILEVBQUFHLFFBQUEsaUJBQ0FyRSxTQUFBLHlCQUNBeUUsZUFBQUgsSUFFQUcsZUFBQUgsR0FDQUwsU0FBQUMiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaGFtYnVyZ2VyX19jb250YWluZXInKTtcclxubGV0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZnVsbHNjcmVlbi1tZW51Jyk7ICBcclxubGV0IGhhbWJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoYW1idXJnZXInKVxyXG5sZXQgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuXHJcbi8vIGxldCB0b2dnbGVNZW51ID0gZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuLy8gICAgIGJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdoYW1idXJnZXJfX2NvbnRhaW5lci0tYWN0aXZlJyk7XHJcbi8vICAgICBoYW1idXJnZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGFtYnVyZ2VyLS1hY3RpdmUnKVxyXG4vLyAgICAgbWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmdWxsc2NyZWVuLW1lbnUtLW9wZW4nKTtcclxuICAgIC8vIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnYm9keS1hY3RpdmUtbWVudScpO1xyXG4vLyB9O1xyXG5cclxuLy8gYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xpY2tNZW51ID0+IHtcclxuLy8gICAgIGNsaWNrTWVudS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4vLyAgICAgYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2hhbWJ1cmdlcl9fY29udGFpbmVyLS1hY3RpdmUnKTtcclxuLy8gICAgIGhhbWJ1cmdlci5jbGFzc0xpc3QudG9nZ2xlKCdoYW1idXJnZXItLWFjdGl2ZScpXHJcbi8vICAgICBtZW51LmNsYXNzTGlzdC50b2dnbGUoJ2Z1bGxzY3JlZW4tbWVudS0tb3BlbicpO1xyXG4vLyAgICAgYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdib2R5LWFjdGl2ZS1tZW51Jyk7XHJcbi8vICAgICAvLyAkKCcubWVudV9fbGluaycpLm9uKCdjbGljaycsIGNsaWNrTWVudSk7XHJcbi8vIH0pOyAgIFxyXG4vLyAkKCcubWVudV9fbGluaycpLm9uKCdjbGljaycsIGNsaWNrTWVudSk7XHJcblxyXG5sZXQgdG9nZ2xlTWVudSA9IGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdoYW1idXJnZXJfX2NvbnRhaW5lci0tYWN0aXZlJyk7XHJcbiAgICBoYW1idXJnZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGFtYnVyZ2VyLS1hY3RpdmUnKVxyXG4gICAgbWVudS5jbGFzc0xpc3QudG9nZ2xlKCdmdWxsc2NyZWVuLW1lbnUtLW9wZW4nKTtcclxuICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnYm9keS1hY3RpdmUtbWVudScpO1xyXG59XHJcblxyXG5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVNZW51KTsgICBcclxuJCgnLmZ1bGxzY3JlZW4tbWVudV9fbGluaycpLm9uKCdjbGljaycsIHRvZ2dsZU1lbnUpO1xyXG4iLCJsZXQgbXlNYXA7XHJcbmNvbnN0IGluaXQgPSAoKSA9PiB7XHJcbiAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcclxuICAgIGNlbnRlcjogWzU1Ljc1MjEzNywgMzcuNTg5MzM1XSxcclxuICAgIHpvb206IDEzLFxyXG4gICAgY29udHJvbHM6IFtdLFxyXG4gIH0pO1xyXG5cclxuICBsZXQgY29vcmRzID0gW1xyXG4gICAgICBbNTUuNzU2MDEyLCAzNy42MDQwMjFdLFxyXG4gICAgICBbNTUuNzUwOTIsIDM3LjYxNTc0Nl0sXHJcbiAgICAgIFs1NS43NDY5ODgsIDM3LjU5MTcxNV0sXHJcbiAgICAgIFs1NS43NDQwNzgsIDM3LjU5MTQxM10sXHJcbiAgICBdLFxyXG4gICAgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oXHJcbiAgICAgIHt9LFxyXG4gICAgICB7XHJcbiAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcclxuICAgICAgICBpY29uTGF5b3V0OiBcImRlZmF1bHQjaW1hZ2VcIixcclxuICAgICAgICBpY29uSW1hZ2VIcmVmOiBcIi4vaW1nL21hcmtlcjgucG5nXCIsXHJcbiAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTM1LCAtNTJdLFxyXG4gICAgICB9XHJcbiAgICApO1xyXG5cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGNvb3Jkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrKGNvb3Jkc1tpXSkpO1xyXG4gIH1cclxuXHJcbiAgbXlNYXAuZ2VvT2JqZWN0cy5hZGQobXlDb2xsZWN0aW9uKTtcclxuXHJcbiAgbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoXCJzY3JvbGxab29tXCIpO1xyXG59O1xyXG5cclxueW1hcHMucmVhZHkoaW5pdCk7XHJcbiIsImxldCBwbGF5ZXI7XHJcblxyXG5jb25zdCBwbGF5ZXJDb250YWluZXIgPSAkKFwiLnBsYXllclwiKTtcclxuY29uc3QgcGxheWVyU3RhcnQgPSAkKFwiLnBsYXllcl9fc3RhcnRcIik7XHJcbmxldCBldmVudHNJbml0ID0gKCkgPT4ge1xyXG4gICQoXCIucGxheWVyX19zdGFydFwiKS5jbGljaygoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKHBsYXllclN0YXJ0Lmhhc0NsYXNzKFwicGxheWVyX19zdGFydC0tYWN0aXZlXCIpKSB7XHJcbiAgICAgIHBsYXllci5wYXVzZVZpZGVvKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwbGF5ZXIucGxheVZpZGVvKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoXCIucGxheWVyX19wbGF5YmFja1wiKS5jbGljaygoZSkgPT4ge1xyXG4gICAgY29uc3QgYmFyID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgY2xpY2tlZFBvc2l0aW9uID0gZS5vcmlnaW5hbEV2ZW50LmxheWVyWDtcclxuXHJcbiAgICBjb25zdCBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQgPSAoY2xpY2tlZFBvc2l0aW9uIC8gYmFyLndpZHRoKCkpICogMTAwO1xyXG4gICAgY29uc3QgbmV3UGxheWJhY2tQb3NpdGlvblNlYyA9XHJcbiAgICAgIChwbGF5ZXIuZ2V0RHVyYXRpb24oKSAvIDEwMCkgKiBuZXdCdXR0b25Qb3NpdGlvblBlcmNlbnQ7XHJcblxyXG4gICAgJChcIi5wbGF5ZXJfX3BsYXliYWNrLWxpbmVcIikuY3NzKHtcclxuICAgICAgd2lkdGg6IGAke25ld0J1dHRvblBvc2l0aW9uUGVyY2VudH0lYCxcclxuICAgIH0pO1xyXG5cclxuICAgIHBsYXllci5zZWVrVG8obmV3UGxheWJhY2tQb3NpdGlvblNlYyk7XHJcbiAgfSk7XHJcblxyXG4gICQoXCIucGxheWVyX19zcGxhc2hcIikuY2xpY2soKGUpID0+IHtcclxuICAgIHBsYXllci5wbGF5VmlkZW8oKTtcclxuICB9KTtcclxuXHJcbiAgJChcIi5wbGF5ZXJfX3ZvbHVtZVwiKS5jbGljaygoZSkgPT4ge1xyXG4gICAgY29uc3QgdkJhciA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IHZDbGlja2VkUG9zaXRpb24gPSBlLm9yaWdpbmFsRXZlbnQubGF5ZXJYO1xyXG4gICAgY29uc3QgbmV3dkJ1dHRvblBvc2l0aW9uUGVyY2VudCA9ICh2Q2xpY2tlZFBvc2l0aW9uIC8gdkJhci53aWR0aCgpKSAqIDEwMDtcclxuXHJcbiAgICAkKFwiLnBsYXllcl9fdm9sdW1lLWJ1dHRvblwiKS5jc3Moe1xyXG4gICAgICBsZWZ0OiBgJHtuZXd2QnV0dG9uUG9zaXRpb25QZXJjZW50fSVgLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcGxheWVyLnNldFZvbHVtZShuZXd2QnV0dG9uUG9zaXRpb25QZXJjZW50KTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGZvcm1hdFRpbWUgPSAodGltZVNlYykgPT4ge1xyXG4gIGNvbnN0IHJvdW5kVGltZSA9IE1hdGgucm91bmQodGltZVNlYyk7XHJcblxyXG4gIGNvbnN0IG1pbnV0ZXMgPSBhZGRaZXJvKE1hdGguZmxvb3Iocm91bmRUaW1lIC8gNjApKTtcclxuICBjb25zdCBzZWNvbmRzID0gYWRkWmVybyhyb3VuZFRpbWUgLSBtaW51dGVzICogNjApO1xyXG5cclxuICBmdW5jdGlvbiBhZGRaZXJvKG51bSkge1xyXG4gICAgcmV0dXJuIG51bSA8IDEwID8gYDAke251bX1gIDogbnVtO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGAke21pbnV0ZXN9IDogJHtzZWNvbmRzfWA7XHJcbn07XHJcblxyXG5jb25zdCBvblBsYXllclJlYWR5ID0gKCkgPT4ge1xyXG4gIGxldCBpbnRlcnZhbDtcclxuICBjb25zdCBkdXJhdGlvblNlYyA9IHBsYXllci5nZXREdXJhdGlvbigpO1xyXG5cclxuICAkKFwiLnBsYXllcl9fZHVyYXRpb24tZXN0aW1hdGVcIikudGV4dChmb3JtYXRUaW1lKGR1cmF0aW9uU2VjKSk7XHJcblxyXG4gIGlmICh0eXBlb2YgaW50ZXJ2YWwgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xyXG4gIH1cclxuXHJcbiAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICBjb25zdCBjb21wbGV0ZWRTZWMgPSBwbGF5ZXIuZ2V0Q3VycmVudFRpbWUoKTtcclxuICAgIGNvbnN0IGNvbXBsZXRlZFBlcmNlbnQgPSAoY29tcGxldGVkU2VjIC8gZHVyYXRpb25TZWMpICogMTAwO1xyXG5cclxuICAgICQoXCIucGxheWVyX19wbGF5YmFjay1saW5lXCIpLmNzcyh7XHJcbiAgICAgIHdpZHRoOiBgJHtjb21wbGV0ZWRQZXJjZW50fSVgLFxyXG4gICAgfSk7XHJcbiAgICAkKFwiLnBsYXllcl9fZHVyYXRpb24tY29tcGxldGVkXCIpLnRleHQoZm9ybWF0VGltZShjb21wbGV0ZWRTZWMpKTtcclxuICB9LCAxMDAwKTtcclxuXHJcbiAgY29uc3Qgdm9sdW1lTnVtYmVyID0gcGxheWVyLmdldFZvbHVtZSgpO1xyXG5cclxuICAkKFwiLnBsYXllcl9fdm9sdW1lLWJ1dHRvblwiKS5jc3Moe1xyXG4gICAgbGVmdDogYCR7dm9sdW1lTnVtYmVyfSVgLFxyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3Qgb25QbGF5ZXJTdGF0ZUNoYW5nZSA9IChldmVudCkgPT4ge1xyXG4gIC8qXHJcbiAgICAgIC0xICjQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUg0LLQuNC00LXQviDQvdC1INC90LDRh9Cw0YLQvilcclxuICAgICAgMCAo0LLQvtGB0L/RgNC+0LjQt9Cy0LXQtNC10L3QuNC1INCy0LjQtNC10L4g0LfQsNCy0LXRgNGI0LXQvdC+KVxyXG4gICAgICAxICjQstC+0YHQv9GA0L7QuNC30LLQtdC00LXQvdC40LUpXHJcbiAgICAgIDIgKNC/0LDRg9C30LApXHJcbiAgICAgIDMgKNCx0YPRhNC10YDQuNC30LDRhtC40Y8pXHJcbiAgICAgIDUgKNCy0LjQtNC10L4g0L/QvtC00LDRjtGCINGA0LXQv9C70LjQutC4KS5cclxuICAgICovXHJcbiAgc3dpdGNoIChldmVudC5kYXRhKSB7XHJcbiAgICBjYXNlIDE6XHJcbiAgICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBsYXllci0tYWN0aXZlXCIpO1xyXG4gICAgICBwbGF5ZXJTdGFydC5hZGRDbGFzcyhcInBsYXllcl9fc3RhcnQtLWFjdGl2ZVwiKTtcclxuICAgICAgYnJlYWs7XHJcblxyXG4gICAgY2FzZSAyOlxyXG4gICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJwbGF5ZXItLWFjdGl2ZVwiKTtcclxuICAgICAgcGxheWVyU3RhcnQucmVtb3ZlQ2xhc3MoXCJwbGF5ZXJfX3N0YXJ0LS1hY3RpdmVcIik7XHJcbiAgICAgIGJyZWFrO1xyXG4gIH1cclxufTtcclxuY29uc3QgcGxheWVyVm9sdW1lSWNvbiA9ICQoXCIucGxheWVyX192b2x1bWUtaWNvblwiKTtcclxuXHJcbiQoXCIucGxheWVyX192b2x1bWUtaWNvblwiKS5jbGljaygoZSkgPT4ge1xyXG4gIGlmIChwbGF5ZXIuZ2V0Vm9sdW1lKCkgPT0gMCkge1xyXG4gICAgcGxheWVyLnNldFZvbHVtZShcIjEwMFwiKTtcclxuICAgIHBsYXllclZvbHVtZUljb24ucmVtb3ZlQ2xhc3MoXCJtdXRlZFwiKTtcclxuICAgICQoXCIucGxheWVyX192b2x1bWUtYnV0dG9uXCIpLmNzcyh7XHJcbiAgICAgIGxlZnQ6IGAxMDAlYCxcclxuICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBwbGF5ZXIuc2V0Vm9sdW1lKFwiMFwiKTtcclxuICAgIHBsYXllclZvbHVtZUljb24uYWRkQ2xhc3MoXCJtdXRlZFwiKTtcclxuICAgICQoXCIucGxheWVyX192b2x1bWUtYnV0dG9uXCIpLmNzcyh7XHJcbiAgICAgIGxlZnQ6IGAwJWAsXHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gb25Zb3VUdWJlSWZyYW1lQVBJUmVhZHkoKSB7XHJcbiAgcGxheWVyID0gbmV3IFlULlBsYXllcihcInl0LXBsYXllclwiLCB7XHJcbiAgICBoZWlnaHQ6IFwicmVtKDM5MilcIixcclxuICAgIHdpZHRoOiBcInJlbSg2NjIpXCIsXHJcbiAgICB2aWRlb0lkOiBcImhrM0tQYTZ6V3pvXCIsXHJcbiAgICBldmVudHM6IHtcclxuICAgICAgb25SZWFkeTogb25QbGF5ZXJSZWFkeSxcclxuICAgICAgb25TdGF0ZUNoYW5nZTogb25QbGF5ZXJTdGF0ZUNoYW5nZSxcclxuICAgIH0sXHJcbiAgICBwbGF5ZXJWYXJzOiB7XHJcbiAgICAgIGNvbnRyb2xzOiAwLFxyXG4gICAgICBkaXNhYmxla2I6IDEsXHJcbiAgICAgIHNob3dpbmZvOiAwLFxyXG4gICAgICByZWw6IDAsXHJcbiAgICAgIGF1dG9wbGF5OiAwLFxyXG4gICAgICBtb2Rlc3RicmFuZGluZzogMCxcclxuICAgIH0sXHJcbiAgfSk7XHJcbn1cclxuZXZlbnRzSW5pdCgpO1xyXG4iLCJjb25zdCB2YWxpZGF0ZUZpZWxkcyA9IChmb3JtLCBmaWVsZHNBcnJheSkgPT4ge1xyXG4gIGZpZWxkc0FycmF5LmZvckVhY2goKGZpZWxkKSA9PiB7XHJcbiAgICBmaWVsZC5yZW1vdmVDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gICAgaWYgKGZpZWxkLnZhbCgpLnRyaW0oKSA9PSBcIlwiKSB7XHJcbiAgICAgIGZpZWxkLmFkZENsYXNzKFwiaW5wdXQtZXJyb3JcIik7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiLmlucHV0LWVycm9yXCIpO1xyXG5cclxuICByZXR1cm4gZXJyb3JGaWVsZHMubGVuZ3RoID09IDA7XHJcbn07XHJcblxyXG4kKFwiLmZvcm1cIikuc3VibWl0KChlKSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCBmb3JtID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpO1xyXG4gIGNvbnN0IHBob25lID0gZm9ybS5maW5kKFwiW25hbWU9J3Bob25lJ11cIik7XHJcbiAgY29uc3QgY29tbWVudCA9IGZvcm0uZmluZChcIltuYW1lPSdjb21tZW50J11cIik7XHJcbiAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcclxuICBjb25zdCBtb2RhbCA9ICQoXCIjbW9kYWxcIik7XHJcbiAgY29uc3QgY29udGVudCA9IG1vZGFsLmZpbmQoXCIubW9kYWxfX2NvbnRlbnRcIik7XHJcblxyXG4gIG1vZGFsLnJlbW92ZUNsYXNzKFwiZXJyb3ItbW9kYWxcIik7XHJcblxyXG4gIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZpZWxkcyhmb3JtLCBbbmFtZSwgcGhvbmUsIGNvbW1lbnQsIHRvXSk7XHJcblxyXG4gIGlmIChpc1ZhbGlkKSB7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0gJC5hamF4KHtcclxuICAgICAgdXJsOiBcImh0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbFwiLFxyXG4gICAgICBtZXRob2Q6IFwicG9zdFwiLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgbmFtZTogbmFtZS52YWwoKSxcclxuICAgICAgICBwaG9uZTogcGhvbmUudmFsKCksXHJcbiAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcclxuICAgICAgICB0bzogdG8udmFsKCksXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcclxuICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEucmVzcG9uc2VKU09OLm1lc3NhZ2U7XHJcbiAgICAgIGNvbnRlbnQudGV4dChtZXNzYWdlKTtcclxuICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcclxuICAgICAgJC5mYW5jeWJveC5vcGVuKHtcclxuICAgICAgICBzcmM6IFwiI21vZGFsXCIsXHJcbiAgICAgICAgdHlwZTogXCJpbmxpbmVcIixcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn0pO1xyXG5cclxuJChcIi5hcHAtY2xvc2UtbW9kYWxcIikuY2xpY2soKGUpID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICQuZmFuY3lib3guY2xvc2UoKTtcclxufSk7XHJcbiIsImNvbnN0IHNlY3Rpb25zID0gJChcInNlY3Rpb25cIik7XHJcbmNvbnN0IGRpc3BsYXkgPSAkKFwiLm1haW5jb250ZW50XCIpO1xyXG5jb25zdCBzaWRlTWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcclxuY29uc3QgbWVudUl0ZW1zID0gc2lkZU1lbnUuZmluZChcImZpeGVkLW1lbnVfX2l0ZW1cIik7XHJcblxyXG5jb25zdCBtb2JpbGVEZXRlY3QgPSBuZXcgTW9iaWxlRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcclxuY29uc3QgaXNNb2JpbGUgPSBtb2JpbGVEZXRlY3QubW9iaWxlKCk7XHJcblxyXG5sZXQgaW5TY3JvbGwgPSBmYWxzZTtcclxuXHJcbnNlY3Rpb25zLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG5jb25zdCBjb3VudFNlY3Rpb25Qb3NpdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcclxuXHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IHNlY3Rpb25FcSAqIC0xMDA7XHJcblxyXG4gICAgaWYgKGlzTmFOKHBvc2l0aW9uKSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCLQv9C10YDQtdC00LDQvdC+INC90LUg0LLQtdGA0L3QvtC1INC30L3QsNGH0LXQvdC40LUg0LIgY291bnRTZWN0aW9uUG9zaXRpb25cIik7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcG9zaXRpb247XHJcbn1cclxuXHJcbmNvbnN0IHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtID0gKGl0ZW1zLCBpdGVtRXEsIGFjdGl2ZUNsYXNzKSA9PiB7XHJcbiAgICBpdGVtcy5lcShpdGVtRXEpLmFkZENsYXNzKGFjdGl2ZUNsYXNzKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxufVxyXG5cclxuY29uc3QgcGVyZm9ybVRyYW5zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcblxyXG4gICAgaWYgKGluU2Nyb2xsKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgdHJhbnNpdGlvbk92ZXIgPSAxMDAwO1xyXG4gICAgY29uc3QgbW91c2VJbmVydGlhT3ZlciA9IDMwMDtcclxuICAgIGluU2Nyb2xsID0gdHJ1ZTtcclxuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNvdW50U2VjdGlvblBvc2l0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgZGlzcGxheS5jc3Moe1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgLFxyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcbiAgICAgICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XHJcbiAgICAgICAgc2VjdGlvbnMuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGluU2Nyb2xsID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKG1lbnVJdGVtcywgc2VjdGlvbkVxLCBcImZpeGVkLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKTtcclxuXHJcblxyXG4gICAgICAgIHNpZGVNZW51XHJcbiAgICAgICAgLmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKVxyXG4gICAgICAgIC5lcShzZWN0aW9uRXEpXHJcbiAgICAgICAgLmFkZENsYXNzKFwiZml4ZWQtbWVudV9faXRlbS0tYWN0aXZlXCIpXHJcbiAgICAgICAgLnNpYmxpbmdzKClcclxuICAgICAgICAucmVtb3ZlQ2xhc3MoXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XHJcbiAgICB9LCB0cmFuc2l0aW9uT3ZlciArIG1vdXNlSW5lcnRpYU92ZXIpO1xyXG4gICAgXHJcbiAgXHJcbn07XHJcblxyXG5jb25zdCB2aWV3cG9ydFNjcm9sbGVyID0gKCkgPT4ge1xyXG4gICAgY29uc3QgYWN0aXZlU2VjdGlvbiA9IHNlY3Rpb25zLmZpbHRlcihcIi5hY3RpdmVcIik7XHJcbiAgICBjb25zdCBuZXh0U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ubmV4dCgpO1xyXG4gICAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQoKSB7XHJcbiAgICAgICAgICAgIGlmKG5leHRTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24obmV4dFNlY3Rpb24uaW5kZXgoKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJldigpIHtcclxuICAgICAgICAgICAgaWYocHJldlNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgIH1cclxuXHJcblxyXG5cclxuXHJcbn07XHJcblxyXG4kKHdpbmRvdykub24oXCJ3aGVlbFwiLCBlPT4ge1xyXG5jb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG5jb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbmlmIChkZWx0YVkgPiAwKSB7XHJcbiAgICBzY3JvbGxlci5uZXh0KCk7XHJcbi8vIHNjcm9sbFZpZXdwb3J0KFwibmV4dFwiKTtcclxufVxyXG5pZiAoZGVsdGFZIDwgMCkge1xyXG4gICAgc2Nyb2xsZXIucHJldigpO1xyXG4gICAgLy8gc2Nyb2xsVmlld3BvcnQoXCJwcmV2XCIpO1xyXG59XHJcbn0pO1xyXG5cclxuJCh3aW5kb3cpLm9uKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG5cclxuICAgIGNvbnN0IHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCB1c2VyVHlwaW5nSW5JbnB1dHMgPSB0YWdOYW1lID09IFwiaW5wdXRcIiB8fCB0YWdOYW1lID09IFwidGV4dGFyZWFcIjtcclxuICAgIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG5cclxuICAgIGlmKHVzZXJUeXBpbmdJbklucHV0cykgcmV0dXJuO1xyXG5cclxuICAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgIGNhc2UgMzg6XHJcbiAgICAgICAgc2Nyb2xsZXIucHJldigpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICBcclxuICAgICAgICBjYXNlIDQwOlxyXG4gICAgICAgICAgICBzY3JvbGxlci5uZXh0KCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgIH0gXHJcblxyXG59KTtcclxuXHJcbiQoXCIud3JhcHBlclwiKS5vbihcInRvdWNobW92ZVwiLCBlID0+IGUucHJldmVudERlZmF1bHQoKSk7XHJcblxyXG4kKFwiW2RhdGEtc2Nyb2xsLXRvXVwiKS5jbGljayhlPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gJHRoaXMuYXR0cihcImRhdGEtc2Nyb2xsLXRvXCIpO1xyXG4gICAgY29uc3QgcmVxU2VjdGlvbiA9ICQoYFtkYXRhLXNlY3Rpb24taWQ9JHt0YXJnZXR9XWApO1xyXG5cclxuICAgIHBlcmZvcm1UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XHJcbn0pO1xyXG5cclxuaWYgKGlzTW9iaWxlKSB7XHJcbi8vaHR0cHM6Ly9naXRodWIuY29tL21hdHRicnlzb24vVG91Y2hTd2lwZS1KcXVlcnktUGx1Z2luXHJcbiQoXCJib2R5XCIpLnN3aXBlKCB7XHJcbiAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24sKSB7XHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcbiAgICAgICAgbGV0IHNjcm9sbERpcmVjdGlvbiA9IFwiXCI7XHJcblxyXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT0gXCJ1cFwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcIm5leHRcIjsgXHJcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PSBcImRvd25cIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJwcmV2XCI7IFxyXG4gICAgICBcclxuICAgICAgICBzY3JvbGxlcltzY3JvbGxEaXJlY3Rpb25dKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0iLCJjb25zdCBsaXN0ID0gJChcIi5wcm9kdWN0cy1tZW51X19saXN0XCIpO1xyXG5cclxubGlzdC5vbihcImNsaWNrXCIsIFwiLnByb2R1Y3RcIiwgZnVuY3Rpb24gKGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgJCh0aGlzKS5zaWJsaW5ncyhcImxpXCIpLnJlbW92ZUNsYXNzKFwicHJvZHVjdC0tYWN0aXZlXCIpO1xyXG4gICQodGhpcykudG9nZ2xlQ2xhc3MoXCJwcm9kdWN0LS1hY3RpdmVcIik7XHJcbiAgbGV0ICRjb250ZW50ID0gJCh0aGlzKS5maW5kKFwiLnByb2R1Y3RfX2NvbnRlbnRcIik7XHJcblxyXG4gIGxldCBjdXJXaWR0aCA9IDA7XHJcbiAgbGV0IG5ld1dpZHRoID0gNTI0O1xyXG5cclxuICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPD0gNzY4ICYmICQod2luZG93KS53aWR0aCgpID4gNDgwKSB7XHJcbiAgICBjdXJXaWR0aCA9ICQoXCIucHJvZHVjdF9fdGl0bGVcIikud2lkdGgoKSAqICQoXCIucHJvZHVjdF9fdGl0bGVcIikubGVuZ3RoO1xyXG4gICAgbmV3V2lkdGggPSAkKHdpbmRvdykud2lkdGgoKSAtIGN1cldpZHRoO1xyXG4gIH1cclxuXHJcbiAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNDgwKSB7XHJcbiAgICBjdXJXaWR0aCA9ICQoXCIucHJvZHVjdF9fdGl0bGVcIikud2lkdGgoKTtcclxuICAgIG5ld1dpZHRoID0gJCh3aW5kb3cpLndpZHRoKCkgLSBjdXJXaWR0aDtcclxuICB9XHJcblxyXG4gIGxpc3QuZmluZChcIi5wcm9kdWN0X19jb250ZW50XCIpLmNzcyhcIndpZHRoXCIsIDApO1xyXG5cclxuICBpZiAoJCh0aGlzKS5oYXNDbGFzcyhcInByb2R1Y3QtLWFjdGl2ZVwiKSkge1xyXG4gICAgJGNvbnRlbnQuY3NzKFwid2lkdGhcIiwgYCR7bmV3V2lkdGh9cHhgKTtcclxuICB9XHJcbn0pO1xyXG4iLCJjb25zdCBzbGlkZXIgPSAkKFwiLnNob3BfX2xpc3RcIikuYnhTbGlkZXIoe1xyXG4gIHBhZ2VyOiBmYWxzZSxcclxuICBjb250cm9sczogZmFsc2UsXHJcbn0pO1xyXG5cclxuJChcIi5zaG9wX19idG5fbGVmdFwiKS5jbGljaygoZSkgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcclxufSk7XHJcbiQoXCIuc2hvcF9fYnRuX3JpZ2h0XCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xyXG59KTtcclxuIiwiY29uc3QgZmluZEJsb2NrQnlBbGlhcyA9IChhbGlhcykgPT4ge1xyXG4gIHJldHVybiAkKFwiLnJldmlld3NfX2l0ZW1cIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcclxuICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZC13aXRoXCIpID09IGFsaWFzO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuJChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJfX2xpbmtcIikuY2xpY2soKGUpID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLW9wZW5cIik7XHJcbiAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcclxuICBjb25zdCBjdXJJdGVtID0gJHRoaXMuY2xvc2VzdChcIi5pbnRlcmFjdGl2ZS1hdmF0YXJcIik7XHJcblxyXG4gIGl0ZW1Ub1Nob3dcclxuICAgIC5hZGRDbGFzcyhcInJldmlld3NfX2l0ZW0tLWFjdGl2ZVwiKVxyXG4gICAgLnNpYmxpbmdzKClcclxuICAgIC5yZW1vdmVDbGFzcyhcInJldmlld3NfX2l0ZW0tLWFjdGl2ZVwiKTtcclxuXHJcbiAgY3VySXRlbVxyXG4gICAgLmFkZENsYXNzKFwiaW50ZXJhY3RpdmUtYXZhdGFyLS1hY3RpdmVcIilcclxuICAgIC5zaWJsaW5ncygpXHJcbiAgICAucmVtb3ZlQ2xhc3MoXCJpbnRlcmFjdGl2ZS1hdmF0YXItLWFjdGl2ZVwiKTtcclxufSk7XHJcbiIsImNvbnN0IG9wZW5JdGVtID0gKGl0ZW0pID0+IHtcclxuICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIuc2xpZGVyX19pdGVtXCIpO1xyXG4gIGNvbnN0IGNvbnRlbnRCbG9jayA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9fZGVzY3JpcHRpb25cIik7XHJcbiAgY29uc3QgdGV4dEJsb2NrID0gY29udGVudEJsb2NrLmZpbmQoXCIuc2xpZGVyX19kZXNjcmlwdGlvbi0td3JhcFwiKTtcclxuICBjb25zdCByZXFIZWlnaHQgPSB0ZXh0QmxvY2suaGVpZ2h0KCk7XHJcblxyXG4gIGNvbnRhaW5lci5hZGRDbGFzcyhcIi5zbGlkZXJfX2l0ZW0tLWFjdGl2ZVwiKTtcclxuICBjb250ZW50QmxvY2suaGVpZ2h0KHJlcUhlaWdodCk7XHJcbn07XHJcblxyXG5jb25zdCBjbG9zZUV2ZXJ5SXRlbSA9IChjb250YWluZXIpID0+IHtcclxuICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9fZGVzY3JpcHRpb25cIik7XHJcbiAgY29uc3QgaXRlbUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9faXRlbVwiKTtcclxuXHJcbiAgaXRlbUNvbnRhaW5lci5yZW1vdmVDbGFzcyhcIi5zbGlkZXJfX2l0ZW0tLWFjdGl2ZVwiKTtcclxuICBpdGVtcy5oZWlnaHQoMCk7XHJcbn07XHJcblxyXG4kKFwiLnNsaWRlcl9fbmFtZVwiKS5jbGljaygoZSkgPT4ge1xyXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIuc2xpZGVyX19saXN0XCIpO1xyXG4gIGNvbnN0IGVsZW1Db250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnNsaWRlcl9faXRlbVwiKTtcclxuICBpZiAoZWxlbUNvbnRhaW5lci5oYXNDbGFzcyhcIi5zbGlkZXJfX2l0ZW0tLWFjdGl2ZVwiKSkge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICAgIG9wZW5JdGVtKCR0aGlzKTtcclxuICB9XHJcbn0pO1xyXG4iXX0=
